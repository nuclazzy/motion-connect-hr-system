code.gs

/**
 * íŒŒì¼ëª…: Code.gs
 */

// ===============================================================
// ì‚¬ìš©ì ì„¤ì • ì˜ì—­
// ===============================================================
const TEMPLATE_IDS = {
  'íœ´ê°€ ì‹ ì²­ì„œ': '1clqbPDkbz2meuzXyjSQa_zcklXr7etrqySPa8f9k-Tw',
  'ì¬ì§ì¦ëª…ì„œ': '1_A2eLH3W401C8VuMVUM8rI845xhfpgSd2B7Qg4xNOMw',
  'íœ´ì§ê³„': '1g2kZpM99mHO8GcbY4oNykE0Co5XvROG1sv9-CM2acN0',
  'ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ': '1fsdGGQAKl4AdHAIBB3A3OT-DOoKxBvhFGzwZj0EfV_I',
  'ê²½ìœ„ì„œ': '1-BvtP2meiuK-cuBSYKAXgSmaGRSWLZkcGt5Rj1-szGA'
};
const DESTINATION_FOLDER_ID = '1XSspvlvNff6HUPvEtyluNMH9htOk6_8d';
const EMPLOYEE_DATA_SHEET_URL = 'https://docs.google.com/spreadsheets/d/1hS0UE8BhzpDi2yLv2CCOU1krncQMOWEAnxTQk0hZrRE/edit';
const LOG_SHEET_URL = 'https://docs.google.com/spreadsheets/d/1g0TAnQdjf3wjgtPkTBltAKKKFTO2ultNDjCLWmcmpKo/edit';


// ===============================================================
// ë©”ì¸ ì„œë²„ ì½”ë“œ
// ===============================================================

/**
 * URL íŒŒë¼ë¯¸í„°ë¥¼ í•œê¸€ ì„œì‹ëª…ìœ¼ë¡œ ë³€í™˜í•˜ê¸° ìœ„í•œ ë§µ
 */
const FORM_TYPE_MAP = {
  'report': 'ê²½ìœ„ì„œ',
  'vacation': 'íœ´ê°€ ì‹ ì²­ì„œ',
  'certificate': 'ì¬ì§ì¦ëª…ì„œ',
  'leave': 'íœ´ì§ê³„',
  'maternity': 'ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ'
};


/**
 * ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ëª¨ë“  ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” í‘œì¤€ í•¨ìˆ˜
 */
function getUserInfo() {
  try {
    const userEmail = Session.getActiveUser().getEmail();

    if (!userEmail) {
      return { status: 'ANONYMOUS', data: null };
    }

    const sheet = SpreadsheetApp.openByUrl(EMPLOYEE_DATA_SHEET_URL).getSheetByName('ì„ê¸ˆí…Œì´ë¸”');
    if (!sheet) {
      throw new Error("'ì„ê¸ˆí…Œì´ë¸”' ì‹œíŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }

    const data = sheet.getRange("A3:S").getValues();

    for (const row of data) {
      const name = row[1]; // Bì—´: ì„±ëª…
      const emailInSheet = row[7]; // Hì—´: ì´ë©”ì¼
      const resignationDate = row[13]; // Nì—´: í‡´ì‚¬ì¼

      if (name && emailInSheet && emailInSheet.toString().trim().toLowerCase() === userEmail.toLowerCase() && !resignationDate) {
        return {
          status: 'SUCCESS',
          data: {
            ì‚¬ë²ˆ: row[0],
            ì„±ëª…: name,
            ë¶€ì„œ: row[3],
            ì§ìœ„: row[4],
            ìƒë…„ì›”ì¼: parseSheetDate(row[5]),
            ì—°ë½ì²˜: row[6],
            ì£¼ì†Œ: row[8],
            ì…ì‚¬ì¼: parseSheetDate(row[12]),
            ì‚¬ìš©ì—°ì°¨: row[16] || 0,
            ë‚¨ì€ì—°ì°¨: row[17] || 0,
            ë‚¨ì€ë³‘ê°€: row[18] || 0
          }
        };
      }
    }
    return { status: 'NOT_FOUND', data: null };
  } catch (e) {
    console.error("getUserInfo Error: " + e.toString());
    return { status: 'ERROR', data: null, message: e.toString() };
  }
}

/**
 * URL íŒŒë¼ë¯¸í„°(e)ì— ë”°ë¼ ì–´ë–¤ ì„œì‹ì„ ë³´ì—¬ì¤„ì§€ ê²°ì •í•˜ì—¬ HTML í…œí”Œë¦¿ì— ì „ë‹¬
 */
function doGet(e) {
  const formParam = e.parameter.form; 
  const docType = FORM_TYPE_MAP[formParam] || ''; 

  const template = HtmlService.createTemplateFromFile('index');
  template.docType = docType;
  template.formMap = FORM_TYPE_MAP;
  template.baseUrl = ScriptApp.getService().getUrl();

  const pageTitle = docType ? `${docType} ìë™ ìƒì„±` : 'ì„œì‹ ìë™ ìƒì„± ì‹œìŠ¤í…œ';

  return template.evaluate()
    .setTitle(pageTitle)
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}


function include(filename) {
  return HtmlService.createHtmlOutputFromFile(filename).getContent();
}

function parseSheetDate(dateValue) {
  if (!dateValue) return null;
  if (dateValue instanceof Date && !isNaN(dateValue)) {
    return Utilities.formatDate(dateValue, "GMT+9", "yyyy-MM-dd");
  }
  if (typeof dateValue === 'string') {
    const trimmedValue = dateValue.trim();
    if (/^\d{4}\.\d{2}\.\d{2}$/.test(trimmedValue)) return trimmedValue.replace(/\./g, '-');
    if (/^\d{2}\.\d{2}\.\d{2}$/.test(trimmedValue)) {
      const parts = trimmedValue.split('.');
      return `20${parts[0]}-${parts[1]}-${parts[2]}`;
    }
  }
  return null;
}

function formatDateToKorean(dateString) {
  if (!dateString || !/^\d{4}-\d{2}-\d{2}$/.test(dateString)) return dateString;
  const parts = dateString.split('-');
  return `${parts[0]}ë…„ ${parts[1]}ì›” ${parts[2]}ì¼`;
}

function getEmployeeVacationInfo(employeeName) {
  try {
    const sheet = SpreadsheetApp.openByUrl(EMPLOYEE_DATA_SHEET_URL).getSheetByName('ì„ê¸ˆí…Œì´ë¸”');
    if (!sheet) throw new Error("'ì„ê¸ˆí…Œì´ë¸”' ì‹œíŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    const data = sheet.getRange("B3:S").getValues();
    for (let i = 0; i < data.length; i++) {
      if (data[i][0] === employeeName) {
        return {
          success: true,
          ì‚¬ìš©ì—°ì°¨: data[i][15] || 0,
          ë‚¨ì€ì—°ì°¨: data[i][16] || 0,
          ë‚¨ì€ë³‘ê°€: data[i][17] || 0,
          rowIndex: i + 3
        };
      }
    }
    return { success: false, message: "ì§ì›ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤." };
  } catch (e) {
    return { success: false, message: "íœ´ê°€ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨: " + e.message };
  }
}

function updateVacationData(employeeName, vacationType, usedDays) {
  const lock = LockService.getScriptLock();
  lock.waitLock(30000);
  try {
    const sheet = SpreadsheetApp.openByUrl(EMPLOYEE_DATA_SHEET_URL).getSheetByName('ì„ê¸ˆí…Œì´ë¸”');
    if (!sheet) throw new Error("'ì„ê¸ˆí…Œì´ë¸”' ì‹œíŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    const vacationInfo = getEmployeeVacationInfo(employeeName);
    if (!vacationInfo.success) throw new Error(vacationInfo.message);

    const rowIndex = vacationInfo.rowIndex;
    const usedDaysFloat = parseFloat(usedDays) || 0;

    if (['ì—°ì°¨', 'ì˜¤ì „ ë°˜ì°¨', 'ì˜¤í›„ ë°˜ì°¨'].includes(vacationType)) {
      const newUsed = (parseFloat(vacationInfo.ì‚¬ìš©ì—°ì°¨) || 0) + usedDaysFloat;
      const newRemaining = (parseFloat(vacationInfo.ë‚¨ì€ì—°ì°¨) || 0) - usedDaysFloat;
      if (newRemaining < 0) throw new Error("ìµœì‹  ì”ì—¬ì¼ìˆ˜ í™•ì¸ ê²°ê³¼, ì—°ì°¨ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.");
      sheet.getRange(`Q${rowIndex}`).setValue(newUsed);
      sheet.getRange(`R${rowIndex}`).setValue(newRemaining);
    } else if (vacationType === 'ë³‘ê°€') {
      const newRemaining = (parseFloat(vacationInfo.ë‚¨ì€ë³‘ê°€) || 0) - usedDaysFloat;
      if (newRemaining < 0) throw new Error("ìµœì‹  ì”ì—¬ì¼ìˆ˜ í™•ì¸ ê²°ê³¼, ë³‘ê°€ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.");
      sheet.getRange(`S${rowIndex}`).setValue(newRemaining);
    }
    return { success: true };
  } catch (e) {
    console.error("íœ´ê°€ ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: " + e.message);
    return { success: false, message: e.message };
  } finally {
    lock.releaseLock();
  }
}

function updateAddress(employeeName, newAddress) {
  try {
    const sheet = SpreadsheetApp.openByUrl(EMPLOYEE_DATA_SHEET_URL).getSheetByName('ì„ê¸ˆí…Œì´ë¸”');
    if (!sheet) throw new Error("'ì„ê¸ˆí…Œì´ë¸”' ì‹œíŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    const data = sheet.getRange("B3:B").getValues();
    for (let i = 0; i < data.length; i++) {
      if (data[i][0] === employeeName) {
        sheet.getRange(`I${i + 3}`).setValue(newAddress);
        return { success: true };
      }
    }
    return { success: false, message: 'ì£¼ì†Œ ì—…ë°ì´íŠ¸ ëŒ€ìƒì„ ì°¾ì§€ ëª»í•¨' };
  } catch (e) {
    console.error("ì£¼ì†Œ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: " + e.message);
    return { success: false, message: e.message };
  }
}

function createDocument(formData) {
  try {
    if (formData.isAddressChanged === 'true') updateAddress(formData.ì„±ëª…, formData.ì£¼ì†Œ);
    
    const docType = formData.docType;
    const templateId = TEMPLATE_IDS[docType];
    if (!templateId) throw new Error(`í…œí”Œë¦¿ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ: ${docType}`);

    if (docType === 'íœ´ê°€ ì‹ ì²­ì„œ') {
      let vacationDays = parseFloat(formData.íœ´ê°€ì¼ìˆ˜) || 0;
      if (['ì˜¤ì „ ë°˜ì°¨', 'ì˜¤í›„ ë°˜ì°¨'].includes(formData.íœ´ê°€í˜•íƒœ)) {
        vacationDays = 0.5;
        formData.íœ´ê°€ì¼ìˆ˜ = '0.5';
      }
      if (['ì—°ì°¨', 'ì˜¤ì „ ë°˜ì°¨', 'ì˜¤í›„ ë°˜ì°¨', 'ë³‘ê°€'].includes(formData.íœ´ê°€í˜•íƒœ) && vacationDays > 0) {
        const vacationInfo = getEmployeeVacationInfo(formData.ì„±ëª…);
        if (!vacationInfo.success) throw new Error(`íœ´ê°€ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨: ${vacationInfo.message}`);
        
        if (['ì—°ì°¨', 'ì˜¤ì „ ë°˜ì°¨', 'ì˜¤í›„ ë°˜ì°¨'].includes(formData.íœ´ê°€í˜•íƒœ)) {
          if (vacationDays > vacationInfo.ë‚¨ì€ì—°ì°¨) throw new Error(`ì—°ì°¨ ì”ì—¬ì¼ìˆ˜ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. (ì‹ ì²­: ${vacationDays}ì¼, ì”ì—¬: ${vacationInfo.ë‚¨ì€ì—°ì°¨}ì¼)`);
        } else if (formData.íœ´ê°€í˜•íƒœ === 'ë³‘ê°€') {
          if (vacationDays > vacationInfo.ë‚¨ì€ë³‘ê°€) throw new Error(`ë³‘ê°€ ì”ì—¬ì¼ìˆ˜ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. (ì‹ ì²­: ${vacationDays}ì¼, ì”ì—¬: ${vacationInfo.ë‚¨ì€ë³‘ê°€}ì¼)`);
        }
      }
    }

    const folder = DriveApp.getFolderById(DESTINATION_FOLDER_ID);
    const templateFile = DriveApp.getFileById(templateId);
    if (docType === 'ì¬ì§ì¦ëª…ì„œ') formData['ë„˜ë²„ë§'] = Utilities.formatDate(new Date(), "GMT+9", "yyMMdd-HH");
    const applicationDate = formData['ì‹ ì²­ì¼'] || formData['ì‹ ì²­ì¼ì'] || Utilities.formatDate(new Date(), "GMT+9", "yyyy-MM-dd");
    const newFileName = `[${applicationDate}] ${formData['ì„±ëª…']}_${docType}`;
    const newFile = templateFile.makeCopy(newFileName, folder);
    const doc = DocumentApp.openById(newFile.getId());
    const body = doc.getBody();

    const dateFieldsToConvert = ['ì‹œì‘ì¼', 'ì¢…ë£Œì¼', 'ì‹ ì²­ì¼', 'ì¶œì‚°ì˜ˆì •ì¼', 'ì¶œì‚°íœ´ê°€ì‹œì‘ì¼', 'ì¶œì‚°íœ´ê°€ì¢…ë£Œì¼', 'ìœ¡ì•„íœ´ì§ì‹œì‘ì¼', 'ìœ¡ì•„íœ´ì§ì¢…ë£Œì¼', 'ìœ¡ì•„ê¸°ë‹¨ì¶•ì‹œì‘ì¼', 'ìœ¡ì•„ê¸°ë‹¨ì¶•ì¢…ë£Œì¼', 'ì „í™˜í˜•ì‹œì‘ì¼', 'ì „í™˜í˜•ì¢…ë£Œì¼', 'ì…ì‚¬ì¼'];
    for (const key in formData) {
      let value = formData[key] || '';
      if (dateFieldsToConvert.includes(key)) value = formatDateToKorean(value);
      if (key === 'íœ´ì§ì¼ìˆ˜' && value && docType === 'íœ´ì§ê³„') value += 'ì¼';
      if (docType === 'íœ´ê°€ ì‹ ì²­ì„œ') {
        if (key === 'íœ´ê°€ê¸°ê°„') {
          if (['ì˜¤ì „ ë°˜ì°¨', 'ì˜¤í›„ ë°˜ì°¨'].includes(formData['íœ´ê°€í˜•íƒœ'])) value = `${formatDateToKorean(formData['ì‹œì‘ì¼'])} (${formData['íœ´ê°€í˜•íƒœ'] === 'ì˜¤ì „ ë°˜ì°¨' ? 'ì˜¤ì „' : 'ì˜¤í›„'})`;
          else if (formData['ì‹œì‘ì¼'] && formData['ì¢…ë£Œì¼']) value = `${formatDateToKorean(formData['ì‹œì‘ì¼'])} ~ ${formatDateToKorean(formData['ì¢…ë£Œì¼'])}`;
        } else if (key === 'íœ´ê°€ì¼ìˆ˜') {
          if (['ì˜¤ì „ ë°˜ì°¨', 'ì˜¤í›„ ë°˜ì°¨'].includes(formData['íœ´ê°€í˜•íƒœ'])) value = '0.5ì¼';
          else if (value) value += 'ì¼';
        }
      }
      body.replaceText(`{{${key}}}`, value);
    }
    doc.saveAndClose();

    if (docType === 'íœ´ê°€ ì‹ ì²­ì„œ') {
      const vacationType = formData.íœ´ê°€í˜•íƒœ;
      let vacationDays = parseFloat(formData.íœ´ê°€ì¼ìˆ˜) || 0;
      if (['ì˜¤ì „ ë°˜ì°¨', 'ì˜¤í›„ ë°˜ì°¨'].includes(vacationType)) vacationDays = 0.5;
      if (['ì—°ì°¨', 'ì˜¤ì „ ë°˜ì°¨', 'ì˜¤í›„ ë°˜ì°¨', 'ë³‘ê°€'].includes(vacationType) && vacationDays > 0) {
        updateVacationData(formData.ì„±ëª…, vacationType, vacationDays);
      }
    }

    const pdfBlob = newFile.getAs('application/pdf');
    const pdfBase64 = Utilities.base64Encode(pdfBlob.getBytes());
    
    logRequestToSheet({
      applicant: formData['ì„±ëª…'],
      documentType: docType,
      department: formData['ë¶€ì„œ'],
      fileName: newFile.getName() + '.pdf'
    });

    return { success: true, pdfBase64: pdfBase64, fileName: newFile.getName() + '.pdf' };
  } catch (e) {
    console.error("createDocument Error: " + e.message, e.stack);
    return { success: false, message: e.message };
  }
}

function logRequestToSheet(logData) {
  try {
    const logSpreadsheet = SpreadsheetApp.openByUrl(LOG_SHEET_URL);
    const now = new Date();
    const sheetName = Utilities.formatDate(now, "GMT+9", "yyyyë…„ MMì›”");
    let sheet = logSpreadsheet.getSheetByName(sheetName);
    if (!sheet) {
      sheet = logSpreadsheet.insertSheet(sheetName, 0);
      const headerRow = ['ì‹ ì²­ì¼ì‹œ', 'ì‹ ì²­ì', 'ë¶€ì„œ', 'ì‹ ì²­ì„œë¥˜', 'ì²˜ë¦¬ìƒíƒœ', 'ë¹„ê³ '];
      sheet.getRange(1, 1, 1, headerRow.length).setValues([headerRow])
           .setFontWeight("bold").setBackground("#4a90e2").setFontColor("#ffffff").setHorizontalAlignment("center");
      sheet.setColumnWidths(1, 6, 150).setColumnWidth(4, 250);
    }
    const newRow = [
      Utilities.formatDate(now, "GMT+9", "yyyy-MM-dd HH:mm:ss"),
      logData.applicant,
      logData.department,
      logData.documentType,
      'ìƒì„±ì™„ë£Œ',
      `PDF ìƒì„±: ${logData.fileName}`
    ];
    sheet.insertRowAfter(1);
    sheet.getRange(2, 1, 1, newRow.length).setValues([newRow]).setBackground("#ffffff").setFontColor("#000000");
  } catch (e) {
    console.error("ë¡œê·¸ ê¸°ë¡ ì‹¤íŒ¨: " + e.toString());
  }
}

index.Html

<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
      :root {
        --primary-color: #4a90e2; --primary-hover-color: #357abd; --text-color: #333;
        --label-color: #555; --border-color: #ddd; --bg-color: #f9fbfd;
        --section-bg-color: #ffffff; --info-bg-color: #e8f4fd; --info-border-color: var(--primary-color);
        --success-color: #2e7d32; --warning-color: #d32f2f;
      }
      body { background-color: var(--bg-color); font-family: 'Noto Sans KR', sans-serif; color: var(--text-color); padding: 20px; -webkit-font-smoothing: antialiased; }
      .wrapper { max-width: 800px; margin: 20px auto; }
      .section { background-color: var(--section-bg-color); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px; margin-bottom: 25px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); }
      .section-title { font-size: 1.4em; font-weight: 700; color: var(--primary-color); margin-top: 0; margin-bottom: 20px; border-bottom: 2px solid var(--primary-color); padding-bottom: 10px; }
      label { font-weight: 500; color: var(--label-color); margin-bottom: 8px; font-size: 0.95em; display: block; }
      input[type="text"], input[type="date"], input[type="time"], select, textarea { width: 100%; box-sizing: border-box; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 1em; font-family: 'Noto Sans KR', sans-serif; transition: all 0.3s ease; }
      input:focus, select:focus, textarea:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.2); }
      .auto-filled { background-color: #f5f5f5; color: #777; }
      .form-row { display: flex; flex-direction: column; margin-bottom: 18px; }
      .action { background-color: var(--primary-color); color: white; font-weight: 500; font-size: 1.1em; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; }
      .action:hover { background-color: var(--primary-hover-color); }
      .action:disabled { background-color: #ccc; cursor: not-allowed; }
      .info-message, .warning-message { padding: 12px; border-radius: 8px; margin-top: 15px; font-weight: 500; }
      .info-message { color: var(--success-color); background-color: #e8f5e9; border: 1px solid #a5d6a7; }
      .warning-message { color: var(--warning-color); background-color: #ffebee; border: 1px solid #ef9a9a; }
      #vacation-info .info-message { background-color: var(--info-bg-color); border: 1px solid var(--info-border-color); color: var(--primary-color); border-left: 5px solid var(--primary-color); }
      #status { margin-top: 15px; font-weight: 500; }
      #loader { display: none; text-align: center; margin: 20px 0; }
      .spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary-color); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 10px auto; }
      @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
      .form-container { display: none; margin-top: 20px; border-top: 1px solid #eee; padding-top: 20px; }
      .calculated-field { background-color: #e8f0fe; border: 1px solid #ccc; padding: 6px; font-weight: bold; border-radius: 6px; display: inline-block; margin-left: 10px; }
      .sub-section-title { font-weight: bold; font-size: 1.1em; margin: 20px 0 10px; color: #1e8e3e; border-left: 4px solid #1e8e3e; padding-left: 8px; }
      .info-box { background-color: #f1f3f4; border-left: 5px solid #ccc; margin: 15px 0; padding: 15px; border-radius: 8px; }
      textarea { min-height: 80px; resize: vertical; }
      #form-link-list { list-style-type: none; padding-left: 0; }
      #form-link-list li { margin-bottom: 8px; }
      #form-link-list li a { display: block; padding: 10px 15px; background-color: #f8f9fa; border-radius: 6px; text-decoration: none; color: var(--primary-color); font-weight: 500; transition: all 0.2s ease-in-out; }
      #form-link-list li a:hover { background-color: #e9ecef; transform: translateX(4px); }
    </style>
  </head>
  <body>
    <script>
      const FORM_MAP = <?!= JSON.stringify(formMap) ?>;
      const BASE_URL = '<?= baseUrl ?>';
    </script>

    <input type="hidden" id="initial-doc-type" value="<?= docType ?>">

    <div class="wrapper">
      <div id="login-section" style="display: none;" class="section">
        <h2 class="section-title">ğŸ”’ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
        <p>Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.</p>
      </div>

      <div id="initial-guide-section" class="section" style="display: none;"></div>
      
      <div id="user-info-section" class="section" style="display: none;">
        <h2 class="section-title">1. ì‹ ì²­ì ì •ë³´ í™•ì¸</h2>
        <div class="form-row"><label for="employee-name">ì„±ëª…</label><input type="text" id="employee-name" class="employee-data auto-filled" name="ì„±ëª…" readonly></div>
        <div id="vacation-info" style="margin-top: 10px;"></div>
      </div>
      
      <div id="form-selection-section" class="section" style="display:none;">
        <h2 class="section-title">2. ì„¸ë¶€ ì •ë³´ ì…ë ¥</h2>
        <div class="form-row"><label>ì‹ ì²­ ì„œë¥˜</label><h3 id="form-title" style="margin:0;padding:12px;background-color:#f0f4f8;border-radius:8px;font-size:1.1em"></h3></div>
        <div class="form-row"><label for="user-dept">ë¶€ì„œ</label><input type="text" id="user-dept" class="employee-data auto-filled" name="ë¶€ì„œ" readonly></div>
        <div class="form-row"><label for="user-pos">ì§ìœ„</label><input type="text" id="user-pos" class="employee-data auto-filled" name="ì§ìœ„" readonly></div>
        <div class="form-row"><label for="user-phone">ì—°ë½ì²˜</label><input type="text" id="user-phone" class="employee-data" name="ì—°ë½ì²˜"></div>
        <div class="form-row"><label for="user-address">ì£¼ì†Œ (ìˆ˜ì • ê°€ëŠ¥)</label><input type="text" id="user-address" class="employee-data" name="ì£¼ì†Œ" onchange="markAddressChanged()"></div>
        <input type="hidden" id="isAddressChanged" name="isAddressChanged" value="false">
        <input type="hidden" class="employee-data" name="ì‚¬ë²ˆ">
        <input type="hidden" class="employee-data" name="ìƒë…„ì›”ì¼">
        <input type="hidden" class="employee-data" name="ì…ì‚¬ì¼">
        
        <div id="ê²½ìœ„ì„œ" class="form-container" style="display:none;"><?!= include('Form.Report'); ?></div>
        <div id="íœ´ê°€ ì‹ ì²­ì„œ" class="form-container" style="display:none;"><?!= include('Form.Vacation'); ?></div>
        <div id="ì¬ì§ì¦ëª…ì„œ" class="form-container" style="display:none;"><?!= include('Form.Certificate'); ?></div>
        <div id="íœ´ì§ê³„" class="form-container" style="display:none;"><?!= include('Form.Leave'); ?></div>
        <div id="ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ" class="form-container" style="display:none;"><?!= include('Form.Maternity'); ?></div>
      </div>
      
      <div id="submission-block" class="section" style="display:none;">
        <button id="submit-button" class="action" onclick="submitForm()">ë¬¸ì„œ ìƒì„±í•˜ê¸°</button>
        <div id="loader"><div class="spinner"></div><p>ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤...</p></div>
        <div id="status"></div>
      </div>
    </div>
    
    <?!= include('JavaScript'); ?>
  </body>
</html>

JavaScript.html

<script>
/**
 * íŒŒì¼ëª…: JavaScript.html
 */
let currentUserData = null;

document.addEventListener("DOMContentLoaded", function() {
  initializeSystem();
  const today = new Date().toISOString().slice(0, 10);
  document.querySelectorAll('.default-today').forEach(input => {
    if (!input.value) input.value = today;
  });
});

function initializeSystem() {
  google.script.run
    .withSuccessHandler(handleUserInfoResponse)
    .withFailureHandler(handleError)
    .getUserInfo();
}

function handleUserInfoResponse(response) {
  const guideSection = document.getElementById('initial-guide-section');
  const userInfoSection = document.getElementById('user-info-section');
  const formSection = document.getElementById('form-selection-section');
  const submissionBlock = document.getElementById('submission-block');
  const loginSection = document.getElementById('login-section');
  
  [guideSection, userInfoSection, formSection, submissionBlock, loginSection].forEach(el => el.style.display = 'none');
  
  switch (response.status) {
    case 'SUCCESS':
      currentUserData = response.data;
      populateFormWithUserData(currentUserData);
      const docType = document.getElementById('initial-doc-type').value;
      if (docType) {
        document.getElementById('form-title').textContent = docType;
        userInfoSection.style.display = 'block';
        formSection.style.display = 'block';
        submissionBlock.style.display = 'block';
        showForm(docType); 
      } else {
        guideSection.style.display = 'block';
        let listHtml = '';
        for (const key in FORM_MAP) {
          listHtml += `<li><a href="${BASE_URL}?form=${key}">${FORM_MAP[key]}</a></li>`;
        }
        guideSection.innerHTML = `<h2 class="section-title">ğŸ“‹ ì‚¬ìš© ê°€ëŠ¥í•œ ì„œì‹ ëª©ë¡</h2><p>ì‘ì„±ì„ ì›í•˜ëŠ” ì„œì‹ì„ ì„ íƒí•˜ì„¸ìš”.</p><ul id="form-link-list">${listHtml}</ul>`;
      }
      break;
    case 'ANONYMOUS':
      loginSection.style.display = 'block';
      break;
    case 'NOT_FOUND':
      guideSection.style.display = 'block';
      guideSection.innerHTML = `<h2 class="section-title">âŒ ì ‘ê·¼ ê¶Œí•œ ì—†ìŒ</h2><p class="warning-message">'ì„ê¸ˆí…Œì´ë¸”' ì‹œíŠ¸ì— ë“±ë¡ëœ êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ ì ‘ì†í•´ì£¼ì„¸ìš”.</p>`;
      break;
    default:
      handleError({ message: response.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì„œë²„ ì˜¤ë¥˜' });
      break;
  }
}

function handleError(error) {
  document.getElementById('initial-guide-section').innerHTML = `<div class="warning-message">âŒ ì‹œìŠ¤í…œ ì˜¤ë¥˜: ${error.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}</div>`;
  console.error("ì‹œìŠ¤í…œ ì˜¤ë¥˜:", error);
}

function populateFormWithUserData(employee) {
  if (!employee) return;
  document.querySelectorAll('.employee-data').forEach(input => {
    const fieldName = input.getAttribute('name');
    if (employee[fieldName] !== undefined) input.value = employee[fieldName] || '';
  });
  updateVacationInfo(employee);
  // ì¬ì§ì¦ëª…ì„œì˜ ì¬ì§ê¸°ê°„ì„ ì¦‰ì‹œ ê³„ì‚°
  if(document.getElementById('ì¬ì§ì¦ëª…ì„œ')) setTimeout(calculateEmploymentPeriod, 100);
}

function updateVacationInfo(employee) {
  const vacationInfoDiv = document.getElementById('vacation-info');
  if (vacationInfoDiv) {
    vacationInfoDiv.innerHTML = `<div class="info-message"><strong>íœ´ê°€ í˜„í™©:</strong> ë‚¨ì€ ì—°ì°¨ ${employee.ë‚¨ì€ì—°ì°¨ || 0}ì¼ | ì‚¬ìš© ì—°ì°¨ ${employee.ì‚¬ìš©ì—°ì°¨ || 0}ì¼ | ë‚¨ì€ ë³‘ê°€ ${employee.ë‚¨ì€ë³‘ê°€ || 0}ì¼</div>`;
  }
}

function markAddressChanged() {
  document.getElementById('isAddressChanged').value = 'true';
}

function showForm(selectedValue) {
  const vacationInfoDiv = document.getElementById('vacation-info');
  if (vacationInfoDiv) {
    const leaveRelatedForms = ['íœ´ê°€ ì‹ ì²­ì„œ', 'ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ', 'íœ´ì§ê³„'];
    vacationInfoDiv.style.display = leaveRelatedForms.includes(selectedValue) ? 'block' : 'none';
  }

  document.querySelectorAll('.form-container').forEach(form => {
    form.style.display = 'none';
  });
  
  const formContainer = document.getElementById(selectedValue);
  if (formContainer) {
    formContainer.style.display = 'block';
  }
}

function toggleOtherField(selectElement, otherFieldId) {
  const otherField = document.getElementById(otherFieldId);
  if (otherField) otherField.style.display = (selectElement.value === 'ê¸°íƒ€') ? 'block' : 'none';
}

function toggleReasonField(selectElement, reasonFieldId) {
  const reasonField = document.getElementById(reasonFieldId);
  if (reasonField) reasonField.style.display = (['ì—°ì°¨', 'ì˜¤ì „ ë°˜ì°¨', 'ì˜¤í›„ ë°˜ì°¨'].includes(selectElement.value)) ? 'none' : 'block';
}

function showSickLeaveWarning(selectElement) {
  const sickLeaveWarningDiv = document.getElementById('sick-leave-warning');
  if (!sickLeaveWarningDiv) return;
  if (selectElement.value === 'ë³‘ê°€') {
    sickLeaveWarningDiv.innerHTML = `<div class="info-message" style="background-color: #fffbe6; border-color: #ffe58f; color: #d46b08;"><strong>âš ï¸ ë³‘ê°€ ì‚¬ìš© ì•ˆë‚´</strong><br>ë³‘ê°€ ì‚¬ìš©ì€ ì—°ì°¨ë¥¼ ëª¨ë‘ ì†Œì§„í•œ í›„, í”¼ì¹˜ ëª»í•  ì‚¬ì •ì´ ìˆì„ ê²½ìš°ì—ë§Œ ì‹ ì²­í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.</div>`;
    sickLeaveWarningDiv.style.display = 'block';
  } else {
    sickLeaveWarningDiv.style.display = 'none';
  }
}

function calculateDays(formId, startDateName, endDateName, resultSpanId, hiddenInputName) {
  const form = document.getElementById(formId);
  const startDate = form.querySelector(`input[name="${startDateName}"]`).value;
  const endDate = form.querySelector(`input[name="${endDateName}"]`).value;
  const resultSpan = document.getElementById(resultSpanId);
  const hiddenInput = form.querySelector(`input[name="${hiddenInputName}"]`);
  if (startDate && endDate) {
    const start = new Date(startDate);
    const end = new Date(endDate);
    if (end < start) { resultSpan.textContent = "ì¢…ë£Œì¼ ì˜¤ë¥˜"; hiddenInput.value = ""; return; }
    const diffDays = Math.ceil(Math.abs(end - start) / (1000 * 60 * 60 * 24)) + 1;
    hiddenInput.value = diffDays;
    resultSpan.textContent = `${diffDays} ì¼`;
  }
}

function calculateHours(formId, startTimeName, endTimeName, resultSpanId, hiddenInputName) {
  const form = document.getElementById(formId);
  const startTime = form.querySelector(`input[name="${startTimeName}"]`).value;
  const endTime = form.querySelector(`input[name="${endTimeName}"]`).value;
  const resultSpan = document.getElementById(resultSpanId);
  const hiddenInput = form.querySelector(`input[name="${hiddenInputName}"]`);
  if (startTime && endTime) {
    const start = new Date(`1970-01-01T${startTime}:00`);
    const end = new Date(`1970-01-01T${endTime}:00`);
    if (end < start) { resultSpan.textContent = "ì¢…ë£Œì‹œê°„ ì˜¤ë¥˜"; hiddenInput.value = ""; return; }
    const diffMinutes = (end - start) / 60000;
    const hours = Math.floor(diffMinutes / 60);
    const minutes = diffMinutes % 60;
    const text = `${hours}ì‹œê°„ ${minutes}ë¶„`;
    resultSpan.textContent = text;
    hiddenInput.value = text;
  }
}

function calculateEmploymentPeriod() {
  const form = document.getElementById('ì¬ì§ì¦ëª…ì„œ');
  if(!form || !form.innerHTML) return;
  const hireDate = form.querySelector('input[name="ì…ì‚¬ì¼"]').value;
  const requestDate = form.querySelector('input[name="ì‹ ì²­ì¼"]').value;
  const resultSpan = document.getElementById('form5_ì¬ì§ì¼');
  const hiddenInput = form.querySelector('input[name="ì¬ì§ì¼"]');
  if (hireDate && requestDate) {
    const start = new Date(hireDate);
    const end = new Date(requestDate);
    if (end < start) { resultSpan.textContent = "ì‹ ì²­ì¼ ì˜¤ë¥˜"; hiddenInput.value = ""; return; }
    let years = end.getFullYear() - start.getFullYear();
    let months = end.getMonth() - start.getMonth();
    if (end.getDate() < start.getDate()) months--;
    if (months < 0) { years--; months += 12; }
    const text = `${years}ë…„ ${months}ê°œì›”`;
    resultSpan.textContent = text;
    hiddenInput.value = text;
  }
}

function submitForm() {
  const docType = document.getElementById('initial-doc-type').value;
  if (!docType) { alert("ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤."); return; }
  
  if (docType === 'íœ´ê°€ ì‹ ì²­ì„œ' && currentUserData) {
    const form = document.getElementById('íœ´ê°€ ì‹ ì²­ì„œ');
    const vacationType = form.querySelector('[name="íœ´ê°€í˜•íƒœ"]').value;
    const vacationDays = parseFloat(form.querySelector('[name="íœ´ê°€ì¼ìˆ˜"]').value) || 0;
    if (vacationDays > 0) {
      if ((['ì—°ì°¨', 'ì˜¤ì „ ë°˜ì°¨', 'ì˜¤í›„ ë°˜ì°¨'].includes(vacationType)) && vacationDays > currentUserData.ë‚¨ì€ì—°ì°¨) {
        alert(`ì—°ì°¨ ì”ì—¬ì¼ìˆ˜ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.`); return;
      }
      if (vacationType === 'ë³‘ê°€' && vacationDays > currentUserData.ë‚¨ì€ë³‘ê°€) {
        alert(`ë³‘ê°€ ì”ì—¬ì¼ìˆ˜ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.`); return;
      }
    }
  }

  let formData = { docType };
  document.querySelectorAll('#user-info-section .employee-data, #form-selection-section .employee-data, #isAddressChanged').forEach(input => {
    if (input.name) formData[input.name] = input.value || '';
  });
  const formContainer = document.getElementById(docType);
  if (formContainer) {
    formContainer.querySelectorAll('input, textarea, select').forEach(input => {
      if (input.name) formData[input.name] = input.value || '';
    });
  }
  if (!currentUserData?.ì„±ëª…) { alert("ì‚¬ìš©ì ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."); return; }
  
  const submitButton = document.getElementById('submit-button');
  const loader = document.getElementById('loader');
  const statusEl = document.getElementById('status');
  loader.style.display = 'block';
  statusEl.textContent = 'ë¬¸ì„œë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...';
  submitButton.disabled = true;

  google.script.run
    .withSuccessHandler(function(response) {
      loader.style.display = 'none';
      submitButton.disabled = false;
      if (response.success) {
        statusEl.innerHTML = `<span class="info-message">âœ… ë¬¸ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</span>`;
        triggerPdfDownload(response.pdfBase64, response.fileName);
        if (docType === 'íœ´ê°€ ì‹ ì²­ì„œ') {
          setTimeout(() => google.script.run.withSuccessHandler(res => {
            if (res.status === 'SUCCESS') populateFormWithUserData(res.data);
          }).getUserInfo(), 1000);
        }
      } else {
        statusEl.innerHTML = `<span class="warning-message">âŒ ì˜¤ë¥˜: ${response.message}</span>`;
        alert('ë¬¸ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ:\n' + response.message);
      }
    })
    .withFailureHandler(handleError)
    .createDocument(formData);
}

function triggerPdfDownload(base64Data, fileName) {
  try {
    const link = document.createElement('a');
    link.href = `data:application/pdf;base64,${base64Data}`;
    link.download = fileName;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  } catch (e) {
    console.error("PDF ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:", e);
  }
}
</script>

FormReport.html

<div class="form-row">
  <label for="report-summary">1. ì‚¬ê±´ê°œìš”</label>
  <textarea id="report-summary" name="ì‚¬ê±´ê°œìš”" rows="3"></textarea>
</div>
<div class="form-row">
  <label for="report-details">2. ì‚¬ê±´ ìƒì„¸ ë‚´ìš©</label>
  <textarea id="report-details" name="ìƒì„¸ë‚´ìš©" rows="6"></textarea>
</div>
<div class="form-row">
  <label for="report-cause">3. ì‚¬ê±´ ë°œìƒ ì›ì¸</label>
  <textarea id="report-cause" name="ì›ì¸ë¶„ì„" rows="4"></textarea>
</div>
<div class="form-row">
  <label for="report-opinion">4. í–¥í›„ ëŒ€ì±… ë° ë³¸ì¸ ì¶”ê°€ ì˜ê²¬</label>
  <textarea id="report-opinion" name="ë³¸ì¸ì˜ê²¬" rows="4"></textarea>
</div>
<div class="form-row">
  <label>ì‹ ì²­ì¼</label>
  <input type="date" name="ì‹ ì²­ì¼" class="default-today">
</div>

FormVacation.html

<div class="form-row">
  <label>íœ´ê°€ ê¸°ê°„</label>
  ì‹œì‘ì¼: <input type="date" name="ì‹œì‘ì¼" onchange="calculateDays('íœ´ê°€ ì‹ ì²­ì„œ', 'ì‹œì‘ì¼', 'ì¢…ë£Œì¼', 'form4_íœ´ê°€ì¼ìˆ˜', 'íœ´ê°€ì¼ìˆ˜')">
  ì¢…ë£Œì¼: <input type="date" name="ì¢…ë£Œì¼" onchange="calculateDays('íœ´ê°€ ì‹ ì²­ì„œ', 'ì‹œì‘ì¼', 'ì¢…ë£Œì¼', 'form4_íœ´ê°€ì¼ìˆ˜', 'íœ´ê°€ì¼ìˆ˜')">
  <span id="form4_íœ´ê°€ì¼ìˆ˜" class="calculated-field">0 ì¼</span>
  <input type="hidden" name="íœ´ê°€ì¼ìˆ˜" value="0">
</div>
<div class="form-row">
  <label for="vac-type">íœ´ê°€ í˜•íƒœ</label>
  <select id="vac-type" name="íœ´ê°€í˜•íƒœ" onchange="toggleOtherField(this, 'form4_other_reason'); toggleReasonField(this, 'form4_reason_field'); showSickLeaveWarning(this);">
    <option value="ì—°ì°¨">ì—°ì°¨</option>
    <option value="ì˜¤ì „ ë°˜ì°¨">ì˜¤ì „ ë°˜ì°¨</option>
    <option value="ì˜¤í›„ ë°˜ì°¨">ì˜¤í›„ ë°˜ì°¨</option>
    <option value="ê²½ì¡°ì‚¬">ê²½ì¡°ì‚¬</option>
    <option value="ë³‘ê°€">ë³‘ê°€</option>
    <option value="ê³µê°€">ê³µê°€</option>
    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
  </select>
</div>
<div id="sick-leave-warning" style="display: none; margin-top: 10px;"></div>
<div id="form4_other_reason" class="form-row" style="display: none;">
  <label>ê¸°íƒ€ ì‚¬ìœ </label>
  <input type="text" name="íœ´ê°€í˜•íƒœ_ê¸°íƒ€">
</div>
<div id="form4_reason_field" class="form-row" style="display: none;">
  <label>ì‚¬ìœ  (ì—°ì°¨/ë°˜ì°¨ ì™¸)</label>
  <textarea name="ì‚¬ìœ " rows="3"></textarea>
</div>
<div id="vacation-warning" style="display: none; margin: 10px 0;"></div>
<div class="form-row">
  <label>ì „ë‹¬ì‚¬í•­ (ì—…ë¬´ ì¸ìˆ˜ì¸ê³„)</label>
  <textarea name="ì „ë‹¬ì‚¬í•­" rows="3"></textarea>
</div>
<div class="form-row">
  <label>ë¹„ìƒì—°ë½ì²˜</label>
  <input type="text" name="ë¹„ìƒì—°ë½ì²˜">
</div>
<div class="form-row">
  <label>ì‹ ì²­ì¼</label>
  <input type="date" name="ì‹ ì²­ì¼" class="default-today">
</div>

FormCertificate.html

<div class="form-row">
  <label>ì…ì‚¬ì¼ (ìë™ ì¡°íšŒ)</label>
  <input type="date" name="ì…ì‚¬ì¼" class="employee-data auto-filled" readonly>
</div>
<div class="form-row">
  <label>ì œì¶œì²˜ (ìš©ë„)</label>
  <input type="text" name="ì œì¶œì²˜">
</div>
<div class="form-row">
  <label>ì‹ ì²­ì¼</label>
  <input type="date" name="ì‹ ì²­ì¼" class="default-today" onchange="calculateEmploymentPeriod()">
</div>
<div class="form-row">
  <label>ì¬ì§ê¸°ê°„:</label>
  <span class="calculated-field" id="form5_ì¬ì§ì¼">0ë…„ 0ê°œì›”</span>
  <input type="hidden" name="ì¬ì§ì¼">
</div>

FormLeave.html

<div class="form-row">
  <label>íœ´ì§ ê¸°ê°„</label>
  ì‹œì‘ì¼: <input type="date" name="ì‹œì‘ì¼" onchange="calculateDays('íœ´ì§ê³„', 'ì‹œì‘ì¼', 'ì¢…ë£Œì¼', 'form2_íœ´ì§ì¼ìˆ˜', 'íœ´ì§ì¼ìˆ˜')">
  ì¢…ë£Œì¼: <input type="date" name="ì¢…ë£Œì¼" onchange="calculateDays('íœ´ì§ê³„', 'ì‹œì‘ì¼', 'ì¢…ë£Œì¼', 'form2_íœ´ì§ì¼ìˆ˜', 'íœ´ì§ì¼ìˆ˜')">
  <span id="form2_íœ´ì§ì¼ìˆ˜" class="calculated-field">0 ì¼</span>
  <input type="hidden" name="íœ´ì§ì¼ìˆ˜" value="0">
</div>
<div class="form-row">
  <label>íœ´ì§í˜•íƒœ</label>
  <select name="íœ´ì§í˜•íƒœ" onchange="toggleOtherField(this, 'form2_other_reason')">
    <option value="ë¬´ê¸‰íœ´ì§">ë¬´ê¸‰íœ´ì§</option>
    <option value="ìœ ê¸‰íœ´ì§">ìœ ê¸‰íœ´ì§</option>
    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
  </select>
</div>
<div id="form2_other_reason" class="form-row" style="display: none;">
  <label>ê¸°íƒ€ ì‚¬ìœ </label>
  <input type="text" name="íœ´ì§í˜•íƒœ_ê¸°íƒ€">
</div>
<div class="form-row">
  <label>íœ´ì§ì‚¬ìœ </label>
  <textarea name="íœ´ì§ì‚¬ìœ " rows="3"></textarea>
</div>
<div class="form-row">
  <label>ì „ë‹¬ì‚¬í•­</label>
  <textarea name="ì „ë‹¬ì‚¬í•­" rows="3"></textarea>
</div>
<div class="form-row">
  <label>ì‹ ì²­ì¼</label>
  <input type="date" name="ì‹ ì²­ì¼" class="default-today">
</div>

FormMaternity.html

<div class="form-row">
  <label>ì¶œì‚°ì˜ˆì •ì¼</label>
  <input type="date" name="ì¶œì‚°ì˜ˆì •ì¼">
</div>

<h4 class="sub-section-title">ì¶œì‚°ì „í›„íœ´ê°€</h4>
<div class="form-row">
  <label>ì‹œì‘ì¼</label>
  <input type="date" name="ì¶œì‚°íœ´ê°€ì‹œì‘ì¼" onchange="calculateDays('ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ', 'ì¶œì‚°íœ´ê°€ì‹œì‘ì¼', 'ì¶œì‚°íœ´ê°€ì¢…ë£Œì¼', 'form3_íœ´ê°€ì¼ìˆ˜', 'íœ´ê°€ì¼ìˆ˜')">
</div>
<div class="form-row">
  <label>ì¢…ë£Œì¼</label>
  <input type="date" name="ì¶œì‚°íœ´ê°€ì¢…ë£Œì¼" onchange="calculateDays('ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ', 'ì¶œì‚°íœ´ê°€ì‹œì‘ì¼', 'ì¶œì‚°íœ´ê°€ì¢…ë£Œì¼', 'form3_íœ´ê°€ì¼ìˆ˜', 'íœ´ê°€ì¼ìˆ˜')">
</div>
<div class="form-row">
  <label>íœ´ê°€ì¼ìˆ˜:</label>
  <span class="calculated-field" id="form3_íœ´ê°€ì¼ìˆ˜">0 ì¼</span>
  <input type="hidden" name="íœ´ê°€ì¼ìˆ˜">
</div>

<h4 class="sub-section-title">ìœ¡ì•„íœ´ì§</h4>
<div class="form-row">
  <label>ì‹œì‘ì¼</label>
  <input type="date" name="ìœ¡ì•„íœ´ì§ì‹œì‘ì¼" onchange="calculateDays('ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ', 'ìœ¡ì•„íœ´ì§ì‹œì‘ì¼', 'ìœ¡ì•„íœ´ì§ì¢…ë£Œì¼', 'form3_ìœ¡ì•„íœ´ì§ì¼ìˆ˜', 'ìœ¡ì•„íœ´ì§ì¼ìˆ˜')">
</div>
<div class="form-row">
  <label>ì¢…ë£Œì¼</label>
  <input type="date" name="ìœ¡ì•„íœ´ì§ì¢…ë£Œì¼" onchange="calculateDays('ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ', 'ìœ¡ì•„íœ´ì§ì‹œì‘ì¼', 'ìœ¡ì•„íœ´ì§ì¢…ë£Œì¼', 'form3_ìœ¡ì•„íœ´ì§ì¼ìˆ˜', 'ìœ¡ì•„íœ´ì§ì¼ìˆ˜')">
</div>
<div class="form-row">
  <label>íœ´ì§ì¼ìˆ˜:</label>
  <span class="calculated-field" id="form3_ìœ¡ì•„íœ´ì§ì¼ìˆ˜">0 ì¼</span>
  <input type="hidden" name="ìœ¡ì•„íœ´ì§ì¼ìˆ˜">
</div>

<h4 class="sub-section-title">ìœ¡ì•„ê¸° ê·¼ë¡œì‹œê°„ ë‹¨ì¶•</h4>
<div class="form-row">
  <label>ì‹œì‘ì¼</label>
  <input type="date" name="ìœ¡ì•„ê¸°ë‹¨ì¶•ì‹œì‘ì¼" onchange="calculateDays('ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ', 'ìœ¡ì•„ê¸°ë‹¨ì¶•ì‹œì‘ì¼', 'ìœ¡ì•„ê¸°ë‹¨ì¶•ì¢…ë£Œì¼', 'form3_ìœ¡ì•„ê¸°ë‹¨ì¶•ì¼ìˆ˜', 'ìœ¡ì•„ê¸°ë‹¨ì¶•ì¼ìˆ˜')">
</div>
<div class="form-row">
  <label>ì¢…ë£Œì¼</label>
  <input type="date" name="ìœ¡ì•„ê¸°ë‹¨ì¶•ì¢…ë£Œì¼" onchange="calculateDays('ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ', 'ìœ¡ì•„ê¸°ë‹¨ì¶•ì‹œì‘ì¼', 'ìœ¡ì•„ê¸°ë‹¨ì¶•ì¢…ë£Œì¼', 'form3_ìœ¡ì•„ê¸°ë‹¨ì¶•ì¼ìˆ˜', 'ìœ¡ì•„ê¸°ë‹¨ì¶•ì¼ìˆ˜')">
</div>
<div class="form-row">
  <label>ë‹¨ì¶•ì¼ìˆ˜:</label>
  <span class="calculated-field" id="form3_ìœ¡ì•„ê¸°ë‹¨ì¶•ì¼ìˆ˜">0 ì¼</span>
  <input type="hidden" name="ìœ¡ì•„ê¸°ë‹¨ì¶•ì¼ìˆ˜">
</div>
<div class="form-row">
  <label>ë‹¨ì¶• í›„ ê·¼ë¬´ ì‹œì‘ ì‹œê°„</label>
  <input type="time" name="ìœ¡ì•„ê¸°ê·¼ë¬´ì‹œì‘ì‹œê°„" onchange="calculateHours('ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ', 'ìœ¡ì•„ê¸°ê·¼ë¬´ì‹œì‘ì‹œê°„', 'ìœ¡ì•„ê¸°ê·¼ë¬´ì¢…ë£Œì‹œê°„', 'form3_ìœ¡ì•„ê¸°ë‹¨ì¶•ê·¼ë¬´ì‹œê°„', 'ìœ¡ì•„ê¸°ë‹¨ì¶•ê·¼ë¬´ì‹œê°„')">
</div>
<div class="form-row">
  <label>ë‹¨ì¶• í›„ ê·¼ë¬´ ì¢…ë£Œ ì‹œê°„</label>
  <input type="time" name="ìœ¡ì•„ê¸°ê·¼ë¬´ì¢…ë£Œì‹œê°„" onchange="calculateHours('ì¶œì‚°íœ´ê°€ ë° ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ', 'ìœ¡ì•„ê¸°ê·¼ë¬´ì‹œì‘ì‹œê°„', 'ìœ¡ì•„ê¸°ê·¼ë¬´ì¢…ë£Œì‹œê°„', 'form3_ìœ¡ì•„ê¸°ë‹¨ì¶•ê·¼ë¬´ì‹œê°„', 'ìœ¡ì•„ê¸°ë‹¨ì¶•ê·¼ë¬´ì‹œê°„')">
</div>
<div class="form-row">
  <label>ë‹¨ì¶• ê·¼ë¬´ì‹œê°„:</label>
  <span class="calculated-field" id="form3_ìœ¡ì•„ê¸°ë‹¨ì¶•ê·¼ë¬´ì‹œê°„">0 ì‹œê°„</span>
  <input type="hidden" name="ìœ¡ì•„ê¸°ë‹¨ì¶•ê·¼ë¬´ì‹œê°„">
</div>

<h4 class="sub-section-title">ì „í™˜í˜• ì‹œê°„ ì„ íƒì œ 
  <button type="button" onclick="showInfoBox('form3_info_box')" style="margin-left: 10px; padding: 5px 10px; background: #4a90e2; color: white; border: none; border-radius: 4px; cursor: pointer;">ì œë„ì•ˆë‚´ ë³´ê¸°</button>
</h4>
<div class="info-box" id="form3_info_box" style="display: none;">
  <h4>'ìœ¡ì•„ê¸° ê·¼ë¡œì‹œê°„ ë‹¨ì¶•' ì œë„ ì•ˆë‚´</h4>
  <p><b>ëŒ€ìƒ:</b> ë§Œ 8ì„¸ ì´í•˜ ë˜ëŠ” ì´ˆë“±í•™êµ 2í•™ë…„ ì´í•˜ ìë…€ë¥¼ ë‘” ì§ì›<br>
  <b>ê¸°ê°„:</b> ê¸°ë³¸ 1ë…„ ì´ë‚´ (ë¯¸ì‚¬ìš© ìœ¡ì•„íœ´ì§ ê¸°ê°„ ê°€ì‚° ê°€ëŠ¥)<br>
  <b>ê·¼ë¬´ì‹œê°„:</b> ì£¼ 15ì‹œê°„ ì´ìƒ ~ 35ì‹œê°„ ì´í•˜<br>
  <b>ë¶„í•  ì‚¬ìš©:</b> ê°€ëŠ¥ (1íšŒ ìµœì†Œ 3ê°œì›” ì´ìƒ)<br>
  <b>ì¤‘ìš”:</b> ê·¼ë¡œì‹œê°„ ë‹¨ì¶•ì„ ì´ìœ ë¡œ ë¶ˆë¦¬í•œ ì²˜ìš°ë¥¼ ë°›ì§€ ì•Šìœ¼ë©°, ì¢…ë£Œ í›„ ì› ì§ë¬´ë¡œ ë³µê·€í•©ë‹ˆë‹¤.</p>
</div>
<div class="form-row">
  <label>ì‹œì‘ì¼</label>
  <input type="date" name="ì „í™˜í˜•ì‹œì‘ì¼">
</div>
<div class="form-row">
  <label>ì¢…ë£Œì¼</label>
  <input type="date" name="ì „í™˜í˜•ì¢…ë£Œì¼">
</div>
<div class="form-row">
  <label>ë¹„ê³ </label>
  <textarea name="ë¹„ê³ " rows="3"></textarea>
</div>
<div class="form-row">
  <label>ì‹ ì²­ì¼</label>
  <input type="date" name="ì‹ ì²­ì¼" class="default-today">
</div>