# íƒ„ë ¥ê·¼ë¬´ì œ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ ë³´ê³ ì„œ

## ðŸ“‹ êµ¬í˜„ ê°œìš”

2025ë…„ 8ì›” 5ì¼ ê¸°ì¤€ìœ¼ë¡œ **íƒ„ë ¥ê·¼ë¬´ì œ ì‹œìŠ¤í…œ**ì´ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ì‹œìŠ¤í…œì€ í•œêµ­ ê·¼ë¡œê¸°ì¤€ë²•ì— ë”°ë¥¸ 3ê°œì›” ë‹¨ìœ„ íƒ„ë ¥ê·¼ë¬´ì œë¥¼ ì§€ì›í•˜ë©°, ì•¼ê°„ê·¼ë¬´ ìˆ˜ë‹¹ì€ ë§¤ì›” ë³„ë„ ì§€ê¸‰í•˜ê³ , ì´ˆê³¼ê·¼ë¬´ ìˆ˜ë‹¹ì€ 3ê°œì›” í›„ ì •ì‚°í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ìž‘ë™í•©ë‹ˆë‹¤.

## ðŸŽ¯ í•µì‹¬ ê¸°ëŠ¥

### 1. ë™ì  ì´ˆê³¼ê·¼ë¬´ ìž„ê³„ê°’ ì‹œìŠ¤í…œ
- **ì¼ë°˜ ê¸°ê°„**: 8ì‹œê°„ ì´ˆê³¼ê·¼ë¬´ ìž„ê³„ê°’
- **íƒ„ë ¥ê·¼ë¬´ì œ ê¸°ê°„ (2025.06.01-08.31)**: 12ì‹œê°„ ì´ˆê³¼ê·¼ë¬´ ìž„ê³„ê°’
- ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ë¦¬ê±°ì—ì„œ ìžë™ìœ¼ë¡œ ë‚ ì§œë³„ ìž„ê³„ê°’ ê²°ì •

### 2. ì•¼ê°„ê·¼ë¬´ ìˆ˜ë‹¹ ë§¤ì›” ìžë™ ì§€ê¸‰
- **ì§€ê¸‰ ì‹œì **: ë§¤ì›” ë§ ìžë™ ê³„ì‚°
- **ëŒ€ìƒ ì‹œê°„**: 22:00-06:00 ì•¼ê°„ê·¼ë¬´ì‹œê°„
- **ê³„ì‚° ê³µì‹**: ì•¼ê°„ê·¼ë¬´ì‹œê°„ Ã— ì‹œê¸‰ Ã— 1.5ë°°
- **íƒ„ë ¥ê·¼ë¬´ì œì™€ ë…ë¦½**: ë¶„ê¸° ì •ì‚°ê³¼ ê´€ê³„ì—†ì´ ë§¤ì›” ì§€ê¸‰

### 3. 3ê°œì›” íƒ„ë ¥ê·¼ë¬´ì œ ì •ì‚°
- **ì •ì‚° ê¸°ì¤€**: 3ê°œì›” í‰ê·  ì£¼ë‹¹ 40ì‹œê°„ ì´ˆê³¼ë¶„
- **ì•¼ê°„ìˆ˜ë‹¹ ì°¨ê°**: ì´ë¯¸ ì§€ê¸‰ëœ ì•¼ê°„ìˆ˜ë‹¹ ì‹œê°„ë§Œí¼ ì°¨ê°
- **ì •ì‚° ê³µì‹**: (ì´ê·¼ë¬´ì‹œê°„ - 480ì‹œê°„ - ì•¼ê°„ì‹œê°„) Ã— ì‹œê¸‰ Ã— 1.5ë°°

### 4. ì €ë…ì‹ì‚¬ ì‹œê°„ ìžë™ ê°ì§€
- **ì¡°ê±´**: 8ì‹œê°„ ì´ìƒ ê·¼ë¬´ + 19:00 ì‹œì  íšŒì‚¬ ìž¬ì‹¤
- **ì°¨ê°**: ìžë™ìœ¼ë¡œ 1ì‹œê°„ ì°¨ê°
- Google Apps Script ì›ë³¸ ë¡œì§ ì™„ì „ ì´ì‹

## ðŸ“ êµ¬í˜„ëœ íŒŒì¼ë“¤

### 1. í•µì‹¬ ë¡œì§ íŒŒì¼
```
src/lib/flexible-work-utils.ts       # íƒ„ë ¥ê·¼ë¬´ì œ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
src/lib/monthly-night-pay.ts         # ì•¼ê°„ìˆ˜ë‹¹ ë§¤ì›” ì§€ê¸‰ ë¡œì§
src/lib/quarterly-settlement.ts      # ë¶„ê¸°ë³„ ì •ì‚° ê³„ì‚° ë¡œì§
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
```
flexible-work-trigger-update.sql     # ë™ì  ìž„ê³„ê°’ íŠ¸ë¦¬ê±° í•¨ìˆ˜
quarterly-flexible-work-schema.sql   # ë¶„ê¸°ë³„ ê´€ë¦¬ í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ
```

### 3. UI ì»´í¬ë„ŒíŠ¸
```
src/components/QuarterlyFlexibleWorkManager.tsx  # ê´€ë¦¬ìžìš© ë¶„ê¸°ë³„ ê´€ë¦¬ UI (Supabase ì§ì ‘ ì—°ë™)
```

## ðŸ”§ ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

### ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ë¦¬ê±° ë¡œì§
```sql
-- ë‚ ì§œë³„ ì´ˆê³¼ê·¼ë¬´ ìž„ê³„ê°’ ë™ì  ê²°ì •
CREATE OR REPLACE FUNCTION get_overtime_threshold(work_date DATE)
RETURNS INTEGER AS $$
BEGIN
  IF work_date >= '2025-06-01' AND work_date <= '2025-08-31' THEN
    RETURN 12; -- íƒ„ë ¥ê·¼ë¬´ì œ ê¸°ê°„: 12ì‹œê°„
  ELSE
    RETURN 8;  -- ì¼ë°˜ ê¸°ê°„: 8ì‹œê°„
  END IF;
END;
$$
```

### TypeScript ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
```typescript
// ì´ˆê³¼ê·¼ë¬´ ìž„ê³„ê°’ ê²°ì •
export function getOvertimeThreshold(
  date: string,
  flexSettings: FlexibleWorkSettings[]
): number {
  const flexSetting = getFlexibleWorkSetting(date, flexSettings)
  return flexSetting ? 12 : 8
}

// ì•¼ê°„ê·¼ë¬´ì‹œê°„ ê³„ì‚° (22:00-06:00)
export function calculateNightHours(
  checkInTime: string,
  checkOutTime: string
): number

// ì €ë…ì‹ì‚¬ ì‹œê°„ ìžë™ ê°ì§€
export function detectDinnerBreak(
  checkInTime: string,
  checkOutTime: string,
  totalWorkHours: number
): boolean
```

## ðŸ—ï¸ ì•„í‚¤í…ì²˜ ê°œì„ ì‚¬í•­

### 1. API Route ì œê±°
ê¸°ì¡´ `/api/admin/work-policies` ë“±ì˜ API Route í˜¸ì¶œì„ **Supabase ì§ì ‘ ì—°ë™**ìœ¼ë¡œ ë³€ê²½:

```typescript
// Before (API Route)
const response = await fetch('/api/admin/work-policies')

// After (Direct Supabase)
const { data, error } = await supabase
  .from('users')
  .select('id')
  .eq('work_type', 'ì •ê·œì§')
```

### 2. ì„±ëŠ¥ ìµœì í™”
- ìºì‹±ëœ ì‹œìŠ¤í…œ ì„¤ì • ì‚¬ìš©
- ì›”ë³„/ì¼ë³„ ë°ì´í„° íš¨ìœ¨ì  ì§‘ê³„
- PostgreSQL íŠ¸ë¦¬ê±°ë¥¼ í†µí•œ ì‹¤ì‹œê°„ ê³„ì‚°

## ðŸ“Š ì‹¤ì œ ë°ì´í„° ì²˜ë¦¬ ì˜ˆì‹œ

### 2025ë…„ 6-7-8ì›” íƒ„ë ¥ê·¼ë¬´ì œ ì ìš© ì‹œë‚˜ë¦¬ì˜¤:

1. **6ì›”**: ì´ 190ì‹œê°„ ê·¼ë¬´ (ì•¼ê°„ 20ì‹œê°„)
2. **7ì›”**: ì´ 180ì‹œê°„ ê·¼ë¬´ (ì•¼ê°„ 15ì‹œê°„)  
3. **8ì›”**: ì´ 170ì‹œê°„ ê·¼ë¬´ (ì•¼ê°„ 10ì‹œê°„)

**ê³„ì‚° ê²°ê³¼:**
- ì´ ê·¼ë¬´ì‹œê°„: 540ì‹œê°„
- ê¸°ì¤€ ì‹œê°„: 480ì‹œê°„ (40ì‹œê°„ Ã— 12ì£¼)
- ì´ˆê³¼ ì‹œê°„: 60ì‹œê°„
- ì•¼ê°„ ì‹œê°„: 45ì‹œê°„ (ë§¤ì›” ìˆ˜ë‹¹ ì§€ê¸‰ë¨)
- **ìµœì¢… ì´ˆê³¼ìˆ˜ë‹¹ ëŒ€ìƒ**: 15ì‹œê°„ (60 - 45)
- **ì´ˆê³¼ìˆ˜ë‹¹**: 15ì‹œê°„ Ã— ì‹œê¸‰ Ã— 1.5ë°°

## âœ… í…ŒìŠ¤íŠ¸ í˜„í™©

### ë¹Œë“œ ì„±ê³µ
```bash
âœ“ Compiled successfully
âœ“ Generating static pages (34/34)
âœ“ Finalizing page optimization
```

### ê¸°ëŠ¥ ê²€ì¦ ì™„ë£Œ
- [x] íƒ„ë ¥ê·¼ë¬´ì œ ê¸°ê°„ ì¡°íšŒ
- [x] ë™ì  ì´ˆê³¼ê·¼ë¬´ ìž„ê³„ê°’ ì ìš©
- [x] ì•¼ê°„ê·¼ë¬´ ìˆ˜ë‹¹ ê³„ì‚°
- [x] 3ê°œì›” ì •ì‚° ë¡œì§
- [x] ì €ë…ì‹ì‚¬ ì‹œê°„ ìžë™ ê°ì§€
- [x] Supabase ì§ì ‘ ì—°ë™

## ðŸš€ ë°°í¬ ì¤€ë¹„ ì™„ë£Œ

ëª¨ë“  êµ¬í˜„ì´ ì™„ë£Œë˜ì–´ í”„ë¡œë•ì…˜ í™˜ê²½ì— ë°°í¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë§Œ ì ìš©í•˜ë©´ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

### ë°°í¬ ì‹œ í•„ìš”í•œ SQL ì‹¤í–‰:
1. `flexible-work-trigger-update.sql` - íŠ¸ë¦¬ê±° í•¨ìˆ˜ ì—…ë°ì´íŠ¸
2. `quarterly-flexible-work-schema.sql` - ë¶„ê¸°ë³„ ê´€ë¦¬ í…Œì´ë¸” ìƒì„± (ì„ íƒì‚¬í•­)

## ðŸ“ˆ í–¥í›„ í™•ìž¥ ê³„íš

1. **ë‹¤ì¤‘ íƒ„ë ¥ê·¼ë¬´ì œ ê¸°ê°„**: ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ê¸°ë°˜ ê´€ë¦¬
2. **ê°œì¸ë³„ ì„¤ì •**: ì§ì›ë³„ ë‹¤ë¥¸ ê¸°ì¤€ì‹œê°„ ì ìš©
3. **ìžë™í™”**: ì›”ë§ ì•¼ê°„ìˆ˜ë‹¹ ìžë™ ì§€ê¸‰ ìŠ¤ì¼€ì¤„ëŸ¬
4. **ë¦¬í¬íŠ¸**: ë¶„ê¸°ë³„ ì •ì‚° ê²°ê³¼ ìƒì„¸ ë¦¬í¬íŠ¸

---

**êµ¬í˜„ìž**: Claude Code  
**ì™„ë£Œì¼**: 2025ë…„ 8ì›” 5ì¼  
**ë²„ì „**: v2.1.0