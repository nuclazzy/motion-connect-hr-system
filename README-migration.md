# 휴가 데이터 마이그레이션 가이드

## 개요
`leave_days` 테이블의 JSON 필드에서 `users` 테이블의 개별 컬럼으로 휴가 데이터를 마이그레이션하는 과정입니다.

## 마이그레이션 순서

### 1단계: 스키마 업데이트
Supabase Dashboard > SQL Editor에서 실행:
```bash
# 파일 내용을 복사하여 실행
supabase-schema-update.sql
```

### 2단계: 데이터 마이그레이션  
스키마 업데이트 완료 후 실행:
```bash
# 파일 내용을 복사하여 실행
migrate-data-to-users.sql
```

### 3단계: 컴포넌트 업데이트
마이그레이션 완료 후 코드 적용:
```bash
# 파일 참고하여 컴포넌트 수정
update-components-for-users-table.ts
```

## 예상 결과

### 기존 방식 (복잡)
- `leave_days` 테이블 + JSON 필드
- 조인 쿼리 필요
- route.ts API 의존성
- 타입 안정성 문제

### 새로운 방식 (단순)
- `users` 테이블에 직접 컬럼
- 단일 테이블 쿼리
- API 의존성 없음
- 타입 안정성 확보

## 마이그레이션 후 확인사항

1. **ke.kim 데이터 확인**:
   - 연차: 17일
   - 병가: 60일  
   - 대체휴가: 8시간
   - 보상휴가: 23시간

2. **모든 직원 데이터 확인**:
   - 연차가 입사일 기준으로 정확히 계산되었는지
   - 사용한 휴가가 올바르게 마이그레이션되었는지

## 장점

1. **단순성**: 복잡한 조인 쿼리 불필요
2. **성능**: 단일 테이블 조회로 빠른 응답
3. **안정성**: route.ts API 의존성 제거
4. **유지보수**: 직관적인 컬럼 구조

## 백업 권장사항

마이그레이션 전에 기존 `leave_days` 테이블 백업:
```sql
-- 백업 테이블 생성
CREATE TABLE leave_days_backup AS SELECT * FROM leave_days;
```

## 완료 후 정리

마이그레이션이 성공적으로 완료되고 테스트가 끝나면:
1. `leave_days` 테이블 삭제 고려
2. 관련 API 엔드포인트 정리
3. 불필요한 조인 쿼리 코드 제거